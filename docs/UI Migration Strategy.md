# Стратегия перехода на новый интерфейс панелей

## Цель

Постепенно перевести существующий интерфейс Текстового Анализатора к многопанельной архитектуре без потери функциональности и с сохранением рабочего состояния на каждом этапе.

## Общая логика перехода

- Переход поэтапный, с прицельным рефакторингом отдельных UI-модулей;
    
- На каждом шаге должен сохраняться **минимально рабочий интерфейс** (MVP);
    
- Старый и новый интерфейсы могут сосуществовать временно через feature-flag или переключение режима (`legacyMode`, `panelMode`).
    

---

## Этап 1. Подготовка инфраструктуры панелей

### 1.1. Внедрение глобального состояния (Zustand)

- Создание `AppState` как центра управления панелями, выделением, режимами;
    
- Введение флагов: `activePanels`, `frozen`, `isSemanticValid` и др.
    

### 1.2. Создание оболочки панели (`<Panel>`)

- Компонент с "липкой" шапкой, заголовком и содержимым;
    
- Поддержка `drag-resize`, `minimize`, `close`;
    
- Подключение панели к глобальному состоянию.
    

---

## Этап 2. Интеграция существующих модулей в панели

### 2.1. Text Editor Panel

- Обернуть текущий редактор в компонент панели;
    
- Добавить шапку с настройками: загрузка, шрифт, цвет;
    
- Синхронизировать курсор и выделение через `AppState`.
    

### 2.2. Card Deck Panel

- Переместить логику отображения карточек в панель;
    
- Вынести фильтрацию, сортировку и навигацию в отдельную шапку;
    
- Реализовать переключение старого/нового вида карточек (на первом этапе).
    

### 2.3. Semantic Linking Map Panel

- Подключить компонент карты как отдельную панель;
    
- Синхронизировать по ID и координатам с редактором и карточками;
    
- Добавить панель управления цветами, формой, отображением иконок.
    

---

## Этап 3. Переход на единое согласованное состояние

### 3.1. Вынесение общей структуры документа

- Центральный массив `paragraphs[]`, доступный всем панелям;
    
- Все изменения текста, редактирования, анализа — через единый стор.
    

### 3.2. Связи между панелями

- Синхронизация hover, selection, scroll
    
- Перекрёстная навигация: кликаешь на карту — подсвечивается текст и карточка.
    

### 3.3. Заморозка интерфейса при анализе

- Флаг `frozen: true` блокирует редактирование
    
- Прогресс анализа отображается в общей панели статуса
    

---

## Этап 4. Очистка и вынос остаточной логики

### 4.1. Удаление старых UI-фрагментов

- Удаление страниц и режимов, которые дублируют функциональность панелей
    

### 4.2. Финальный рефакторинг структуры проекта

- Переместить каждый модуль в `/panels/имя-панели`
    
- Оформить `PanelRegistry` и экспорт всех активных панелей
    

---

## Результат

- Новый интерфейс с параллельной работой редактора, карточек и карты
    
- Полностью реактивное взаимодействие между панелями
    
- Централизованное управление состоянием и структурой текста
    
- Гибкий UI, готовый к расширению новыми видами анализа